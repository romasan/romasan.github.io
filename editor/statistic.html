<html>
<head>

	<script src="./js/jquery.min.js"></script>
	
	<script>

		var _layers = [
			{name: "adventure-escape-game"   },
			{name: "arkanoid-break-game"     },
			{name: "box-five-game"           },
			{name: "bubble-rush-in-fire-game"},
			{name: "avatar"                  },
			{name: "closed-chain-game"       },
			{name: "dynamite-game"           },
			{name: "adventure-puzzle-game"   },
			{name: "finger-maze-game"        },
			{name: "flow-connection-game"    },
			{name: "ghosts-game"             },
			{name: "hex-jewels-game"         },
			{name: "laser-game"              },
			{name: "light-flow-game"         },
			{name: "platformer-shooter-game" },
			{name: "plumber-flow-game"       },
			{name: "hexagon-game"            },
			{name: "points-game"             },
			{name: "run-fast-game"           },
			{name: "shift-it-fast-game"      },
			{name: "sliding-blocks-game"     },
			{name: "tanks-game"              },
			{name: "untangle-web-game"       }
		];

		// images = [];

		const LANDSCAPE = 'landscape', PORTRAIT = 'portrait';
		
		var preload = function(callback) {

			console.log('Preload...');

			let _preload = 0;

			let _container = document.getElementById('preload');

			for(let i in _layers) {
				let _img = document.createElement('img');
				_img.src = '../res/' + _layers[i].name + '.jpg';
				// _img.className = 'hidden';
				_img.onload = () => {
					_preload += 1;
					if(
						_preload == _layers.length &&
						typeof callback == "function"
					) {
						callback();
					}
				}
				_container.appendChild(_img);
				_layers[i].img = _img;
			}
		};

		let statistic = () => {
			
			let wwidth       = document.body.offsetWidth,
			    wheight      = document.body.offsetHeight,
			    worientation = wwidth > wheight ? LANDSCAPE : PORTRAIT;

			console.log('window', wwidth, wheight, worientation);

			let typesCount = {};
			
			for(let i in _layers) {
				// for(let attr in images[i]) {
				let _width  = _layers[i].img.naturalWidth,
				    _height = _layers[i].img.naturalHeight;

				_layers[i].orientation = _width > _height ? LANDSCAPE : PORTRAIT;
				typesCount[_layers[i].orientation] = typesCount[_layers[i].orientation] ? (typesCount[_layers[i].orientation]|0) + 1 : 1;
				_layers[i].width  = _width;
				_layers[i].height = _height;
				
				// console.log(
				// 	'%c' + _layers[i].name,
				// 	'color: white; background:' + (_width > _height ? 'blue' : 'green'),
				// 	_layers[i].width,
				// 	_layers[i].height,
				// 	_layers[i].orientation
				// );
				// }

			}
			
			let minHeigth = (worientation == LANDSCAPE ? wheight / 3 : wheight / 4) | 0;
			console.log('minHeigth', minHeigth);

			let sumWidth = 0;
			for(let i in _layers) {
				_layers[i].newHeight = minHeigth;
				_layers[i].newWidth  = _layers[i].width * (minHeigth / _layers[i].height);
				sumWidth += _layers[i].newWidth;
				$(_layers[i].img).css({
					height: minHeigth + 'px',
					width: _layers[i].newWidth
				});
			}

			$('#preload').show();

			console.log(sumWidth);
			console.log(typesCount);
		}
		
		window.onload = function() {

			preload(statistic);
			// statistic()
		}
	</script>
	<style type="text/css">
		html, body {
			overflow: hidden;
		}
		* {
			margin: 0;
			padding: 0;
		}
		.photos {
			margin: auto;
			font-size: 0px;
		}
		.photo {
			opacity: 0.5;
		}
		.hidden {
			display: none;
		}
	</style>
</head>
<body>

	<div class="hidden" id="preload"></div>
</body>
</html>